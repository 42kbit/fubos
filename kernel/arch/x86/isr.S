#define __ASSEMBLY__
#include <asm/gdt.h>
/*
	idt.c
void isr_handler (u32 isr_num, u32 err_code, isr_regs_t sframe)
*/
.extern isr_handler
__isr_common:
	pusha

	movw %ds, %ax
	pushl %eax

	movw $GDT_KDATA, %ax
	movw %ax, %ds
	movw %ax, %es
	movw %ax, %fs
	movw %ax, %gs
	movw %ax, %ss

	call isr_handler

	popl %eax
	movw %ax, %ds
	movw %ax, %es
	movw %ax, %fs
	movw %ax, %gs
	movw %ax, %ss

	popa
	addl $8, %esp
	sti
	iret

.macro DEF_ISR num _has_error _globl
	.align 16
	.if \_globl
		.globl isr\num
		isr\num:
	.endif
	cli
	.if \_has_error
	.else
		pushl $0x0
	.endif
		pushl $\num
		jmp __isr_common
.endm


.globl __isr_proc_len
__isr_proc_len = __isr_proc_len_end - __isr_proc_len_start

/*
	isr.h
void isr0	(void);
*/
__isr_proc_len_start:
/* division error */
DEF_ISR 0,0,1
__isr_proc_len_end:
DEF_ISR 1,0,0 
DEF_ISR 2,0,0
DEF_ISR 3,0,0
DEF_ISR 4,0,0
DEF_ISR 5,0,0
DEF_ISR 6,0,0
DEF_ISR 7,0,0
DEF_ISR 8,1,0
DEF_ISR 9,0,0

DEF_ISR 10,1,0 
DEF_ISR 11,1,0 
DEF_ISR 12,1,0
DEF_ISR 13,1,0
DEF_ISR 14,1,0
DEF_ISR 15,0,0
DEF_ISR 16,0,0
DEF_ISR 17,0,0
DEF_ISR 18,0,0
DEF_ISR 19,0,0

DEF_ISR 20,0,0 
DEF_ISR 21,0,0 
DEF_ISR 22,0,0
DEF_ISR 23,0,0
DEF_ISR 24,0,0
DEF_ISR 25,0,0
DEF_ISR 26,0,0
DEF_ISR 27,0,0
DEF_ISR 28,0,0
DEF_ISR 29,0,0

DEF_ISR 30,0,0 
DEF_ISR 31,0,0 
DEF_ISR 32,0,0
DEF_ISR 33,0,0
DEF_ISR 34,0,0
DEF_ISR 35,0,0
DEF_ISR 36,0,0
DEF_ISR 37,0,0
DEF_ISR 38,0,0
DEF_ISR 39,0,0

DEF_ISR 40,0,0 
DEF_ISR 41,0,0 
DEF_ISR 42,0,0
DEF_ISR 43,0,0
DEF_ISR 44,0,0
DEF_ISR 45,0,0
DEF_ISR 46,0,0
DEF_ISR 47,0,0
DEF_ISR 48,0,0
DEF_ISR 49,0,0

DEF_ISR 50,0,0 
DEF_ISR 51,0,0 
DEF_ISR 52,0,0
DEF_ISR 53,0,0
DEF_ISR 54,0,0
DEF_ISR 55,0,0
DEF_ISR 56,0,0
DEF_ISR 57,0,0
DEF_ISR 58,0,0
DEF_ISR 59,0,0

DEF_ISR 60,0,0 
DEF_ISR 61,0,0 
DEF_ISR 62,0,0
DEF_ISR 63,0,0
DEF_ISR 64,0,0
DEF_ISR 65,0,0
DEF_ISR 66,0,0
DEF_ISR 67,0,0
DEF_ISR 68,0,0
DEF_ISR 69,0,0

DEF_ISR 70,0,0 
DEF_ISR 71,0,0 
DEF_ISR 72,0,0
DEF_ISR 73,0,0
DEF_ISR 74,0,0
DEF_ISR 75,0,0
DEF_ISR 76,0,0
DEF_ISR 77,0,0
DEF_ISR 78,0,0
DEF_ISR 79,0,0

DEF_ISR 80,0,0 
DEF_ISR 81,0,0 
DEF_ISR 82,0,0
DEF_ISR 83,0,0
DEF_ISR 84,0,0
DEF_ISR 85,0,0
DEF_ISR 86,0,0
DEF_ISR 87,0,0
DEF_ISR 88,0,0
DEF_ISR 89,0,0

DEF_ISR 90,0,0 
DEF_ISR 91,0,0 
DEF_ISR 92,0,0
DEF_ISR 93,0,0
DEF_ISR 94,0,0
DEF_ISR 95,0,0
DEF_ISR 96,0,0
DEF_ISR 97,0,0
DEF_ISR 98,0,0
DEF_ISR 99,0,0

DEF_ISR 100,0,0
DEF_ISR 101,0,0 
DEF_ISR 102,0,0
DEF_ISR 103,0,0
DEF_ISR 104,0,0
DEF_ISR 105,0,0
DEF_ISR 106,0,0
DEF_ISR 107,0,0
DEF_ISR 108,0,0
DEF_ISR 109,0,0

DEF_ISR 110,0,0 
DEF_ISR 111,0,0 
DEF_ISR 112,0,0
DEF_ISR 113,0,0
DEF_ISR 114,0,0
DEF_ISR 115,0,0
DEF_ISR 116,0,0
DEF_ISR 117,0,0
DEF_ISR 118,0,0
DEF_ISR 119,0,0

DEF_ISR 120,0,0 
DEF_ISR 121,0,0 
DEF_ISR 122,0,0
DEF_ISR 123,0,0
DEF_ISR 124,0,0
DEF_ISR 125,0,0
DEF_ISR 126,0,0
DEF_ISR 127,0,0
DEF_ISR 128,0,0
DEF_ISR 129,0,0

DEF_ISR 130,0,0 
DEF_ISR 131,0,0 
DEF_ISR 132,0,0
DEF_ISR 133,0,0
DEF_ISR 134,0,0
DEF_ISR 135,0,0
DEF_ISR 136,0,0
DEF_ISR 137,0,0
DEF_ISR 138,0,0
DEF_ISR 139,0,0

DEF_ISR 140,0,0 
DEF_ISR 141,0,0 
DEF_ISR 142,0,0
DEF_ISR 143,0,0
DEF_ISR 144,0,0
DEF_ISR 145,0,0
DEF_ISR 146,0,0
DEF_ISR 147,0,0
DEF_ISR 148,0,0
DEF_ISR 149,0,0

DEF_ISR 150,0,0 
DEF_ISR 151,0,0 
DEF_ISR 152,0,0
DEF_ISR 153,0,0
DEF_ISR 154,0,0
DEF_ISR 155,0,0
DEF_ISR 156,0,0
DEF_ISR 157,0,0
DEF_ISR 158,0,0
DEF_ISR 159,0,0

DEF_ISR 160,0,0 
DEF_ISR 161,0,0 
DEF_ISR 162,0,0
DEF_ISR 163,0,0
DEF_ISR 164,0,0
DEF_ISR 165,0,0
DEF_ISR 166,0,0
DEF_ISR 167,0,0
DEF_ISR 168,0,0
DEF_ISR 169,0,0

DEF_ISR 170,0,0 
DEF_ISR 171,0,0 
DEF_ISR 172,0,0
DEF_ISR 173,0,0
DEF_ISR 174,0,0
DEF_ISR 175,0,0
DEF_ISR 176,0,0
DEF_ISR 177,0,0
DEF_ISR 178,0,0
DEF_ISR 179,0,0

DEF_ISR 180,0,0 
DEF_ISR 181,0,0 
DEF_ISR 182,0,0
DEF_ISR 183,0,0
DEF_ISR 184,0,0
DEF_ISR 185,0,0
DEF_ISR 186,0,0
DEF_ISR 187,0,0
DEF_ISR 188,0,0
DEF_ISR 189,0,0

DEF_ISR 190,0,0 
DEF_ISR 191,0,0 
DEF_ISR 192,0,0
DEF_ISR 193,0,0
DEF_ISR 194,0,0
DEF_ISR 195,0,0
DEF_ISR 196,0,0
DEF_ISR 197,0,0
DEF_ISR 198,0,0
DEF_ISR 199,0,0

DEF_ISR 200,0,1
DEF_ISR 201,0,0 
DEF_ISR 202,0,0
DEF_ISR 203,0,0
DEF_ISR 204,0,0
DEF_ISR 205,0,0
DEF_ISR 206,0,0
DEF_ISR 207,0,0
DEF_ISR 208,0,0
DEF_ISR 209,0,0

DEF_ISR 210,0,0 
DEF_ISR 211,0,0 
DEF_ISR 212,0,0
DEF_ISR 213,0,0
DEF_ISR 214,0,0
DEF_ISR 215,0,0
DEF_ISR 216,0,0
DEF_ISR 217,0,0
DEF_ISR 218,0,0
DEF_ISR 219,0,0

DEF_ISR 220,0,0 
DEF_ISR 221,0,0 
DEF_ISR 222,0,0
DEF_ISR 223,0,0
DEF_ISR 224,0,0
DEF_ISR 225,0,0
DEF_ISR 226,0,0
DEF_ISR 227,0,0
DEF_ISR 228,0,0
DEF_ISR 229,0,0

DEF_ISR 230,0,0 
DEF_ISR 231,0,0 
DEF_ISR 232,0,0
DEF_ISR 233,0,0
DEF_ISR 234,0,0
DEF_ISR 235,0,0
DEF_ISR 236,0,0
DEF_ISR 237,0,0
DEF_ISR 238,0,0
DEF_ISR 239,0,0

DEF_ISR 240,0,0 
DEF_ISR 241,0,0 
DEF_ISR 242,0,0
DEF_ISR 243,0,0
DEF_ISR 244,0,0
DEF_ISR 245,0,0
DEF_ISR 246,0,0
DEF_ISR 247,0,0
DEF_ISR 248,0,0
DEF_ISR 249,0,0

DEF_ISR 250,0,0 
DEF_ISR 251,0,0 
DEF_ISR 252,0,0
DEF_ISR 253,0,0
DEF_ISR 254,0,0
DEF_ISR 255,0,0
